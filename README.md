# README לפרויקט חיזוי חומרת מחלת הקורונה

## סקירה כללית

פרויקט זה מתמקד בחיזוי חומרת מחלת הקורונה (קל, בינוני, או קשה) באמצעות שתי גישות עיקריות:
1. **מודלים מבוססי נתונים טבלאיים**: ניתוח סימפטומים ותכונות קליניות.
2. **מודלים מבוססי תמונות רדיוגרפיות**: שימוש בטכניקות למידת עומק על תמונות רנטגן של הריאות.

שאלת המחקר שלנו: **באיזו גישה ניתן לחזות בצורה מדויקת יותר את רמת החומרה של מחלת הקורונה?**

---

## רכיבי הפרויקט

### המודלים שנבחנו
1. **מודלים טבלאיים**
   - Random Forest
   - Logistic Regression
   - Decision Tree
   - ANN (רשת עצבית מלאכותית)

2. **מודלים מבוססי תמונות רדיוגרפיות**
   - CNN (Convolutional Neural Network)
   - Transfer Learning באמצעות ResNet50

### תיאור הנתונים
- **נתונים טבלאיים**: תכונות קליניות כמו גיל, מין, תסמינים ורמות חומרה.
  - **עיבוד מקדים**: מחיקת עמודות לא רלוונטיות (כגון מדינה) ואיזון קטגוריות באמצעות מחיקת נתוני ״אין חומרה״.

- **תמונות רדיוגרפיות**: תמונות רנטגן של ריאות שסווגו ידנית לרמות חומרה שונות.
  - **עיבוד מקדים**: נרמול, Augmentation (סיבוב, זום, שינוי ניגודיות) וסיווג ידני.

---

## סיכום תוצאות

| **מודל**              | **דיוק (Accuracy)** | **Precision (ממוצע)** | **Recall (ממוצע)** | **F1**    |
|-------------------------|---------------------|------------------------|--------------------|-----------|
| **Random Forest**      | 26.99%             | 27%                   | 27%                | —        |
| **Logistic Regression** | 32.91%             | 33%                   | 33%                | —        |
| **Decision Tree**       | 32.24%             | 32%                   | 32%                | —        |
| **ANN**                | 33%                | 33%                   | 0.17/0.07/0.75     | 0.23/0.11/0.46 |
| **CNN**                | 67.3%              | 69.8%                 | 68.5%              | 65%       |
| **Transfer Learning**  | **70%**            | **72.5%**             | **70%**            | **71.15%**|

---

## תובנות מרכזיות

1. **ביצועים מיטביים של Transfer Learning**:
   - השיג את התוצאות הגבוהות ביותר בכל המדדים.
   - ניצל משקולות מאומנות מראש (Pre-trained Weights) ממודל ResNet50 והתאים אותן לנתוני המחקר.

2. **מגבלות המודלים האחרים**:
   - **CNN**: ביצועים סבירים אך מוגבלים בגלל כמות הנתונים הקטנה (1,000 תמונות) וזמן האימון הארוך.
   - **מודלים טבלאיים**: ביצועים קרובים לאקראיים בשל חוסר משמעותיות התכונות וחוסר איזון בנתונים.

3. **בעיות באיכות הנתונים**:
   - קטגוריות לא מאוזנות.
   - רעש בתמונות רנטגן, כמו חוטים ואלמנטים חיצוניים שהקשו על המודלים.

4. **שיפורים עתידיים**:
   - **הגדלת מאגר הנתונים**: איסוף וסיווג עשרות אלפי תמונות.
   - **שדרוג המודלים**: מעבר מ-ResNet50 ל-AIDOC, מודל שמומחה בניתוח רדיוגרפי.
   - **שיפור התכונות**: הוספת נתונים קליניים ומידע סביבתי.

---

## נקודות מפתח בשיטות העבודה

### ארכיטקטורת CNN
- שכבות: שלוש שכבות Convolutional עם MaxPooling, שכבת Flatten, ושכבות Fully Connected עם Dropout.
- פונקציית Loss: Binary Cross-Entropy.
- אופטימיזציה: Adam עם Early Stopping והתאמות Learning Rate.

### Transfer Learning
- מודל בסיס: ResNet50 מאומן מראש על ImageNet.
- Fine-Tuning: שכבות אחרונות הותאמו למשימת סיווג בינארי.
- יתרונות: זמן אימון קצר ויכולת הכללה גבוהה גם עם מעט נתונים.

---

## מסקנות
- **Transfer Learning** הציג ביצועים מעולים ויציבים, המאפשרים חיזוי מדויק של חומרת מחלת הקורונה בזמן קצר.
- **CNN** מצריך מאגר נתונים גדול יותר כדי לשפר את הביצועים.
- **מודלים טבלאיים** הראו מגבלות משמעותיות, אך יכולים להשתפר עם תכונות עשירות יותר.

---

## תכנון עתידי
1. **שילוב גישות**: שילוב נתונים טבלאיים ותמונות למודל היברידי.
2. **שיפור הדאטה**: הרחבה וניקוי הנתונים הקיימים.
3. **מודלים מתקדמים**: שימוש במודלים מומחים, כמו AIDOC.
4. **העשרת התכונות**: שילוב מידע קליני ותמונות נוספות לתחזיות מדויקות יותר.

---

## איך להריץ את הפרויקט
1. שיבטו את המאגר:
   ```bash
   git clone <repository-url>
   ```
2. התקנת התלויות:
   ```bash
   pip install -r requirements.txt
   ```
3. הכנת הנתונים:
   - נתונים טבלאיים: יש למקם ב-`data/tabular/`.
   - תמונות: יש למקם ב-`data/images/`.
4. אימון מודלים:
   ```bash
   python train_model.py --model <model_name>
   ```
5. הערכת מודלים:
   ```bash
   python evaluate_model.py --model <model_name>
   ```

---

## מחברים
- חיה בריין
- יובל מימוני
- אורי מור
- מתן לקר

**מרצה**: ד"ר רויטל מרבל

**תאריך הגשה**: 30 בינואר 2025
